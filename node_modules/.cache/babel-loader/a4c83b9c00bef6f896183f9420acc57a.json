{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport * as React from 'react';\nimport { styled } from '@mui/material/styles';\nimport { useCallback, useRef } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { Select, MenuItem, InputLabel, FormHelperText, FormControl, Chip } from '@mui/material';\nimport { FieldTitle, useInput, useChoicesContext, useChoices } from 'ra-core';\nimport { InputHelperText } from './InputHelperText';\nimport { LinearProgress } from '../layout';\nimport { Labeled } from '../Labeled';\nimport { useSupportCreateSuggestion } from './useSupportCreateSuggestion';\n/**\n * An Input component for a select box allowing multiple selections, using an array of objects for the options\n *\n * Pass possible options as an array of objects in the 'choices' attribute.\n *\n * By default, the options are built from:\n *  - the 'id' property as the option value,\n *  - the 'name' property as the option text\n * @example\n * const choices = [\n *    { id: 'programming', name: 'Programming' },\n *    { id: 'lifestyle', name: 'Lifestyle' },\n *    { id: 'photography', name: 'Photography' },\n * ];\n * <SelectArrayInput source=\"tags\" choices={choices} />\n *\n * You can also customize the properties to use for the option name and value,\n * thanks to the 'optionText' and 'optionValue' attributes.\n * @example\n * const choices = [\n *    { _id: 123, full_name: 'Leo Tolstoi', sex: 'M' },\n *    { _id: 456, full_name: 'Jane Austen', sex: 'F' },\n * ];\n * <SelectArrayInput source=\"authors\" choices={choices} optionText=\"full_name\" optionValue=\"_id\" />\n *\n * `optionText` also accepts a function, so you can shape the option text at will:\n * @example\n * const choices = [\n *    { id: 123, first_name: 'Leo', last_name: 'Tolstoi' },\n *    { id: 456, first_name: 'Jane', last_name: 'Austen' },\n * ];\n * const optionRenderer = choice => `${choice.first_name} ${choice.last_name}`;\n * <SelectArrayInput source=\"authors\" choices={choices} optionText={optionRenderer} />\n *\n * `optionText` also accepts a React Element, that can access\n * the related choice through the `useRecordContext` hook. You can use Field components there.\n * @example\n * const choices = [\n *    { id: 123, first_name: 'Leo', last_name: 'Tolstoi' },\n *    { id: 456, first_name: 'Jane', last_name: 'Austen' },\n * ];\n * const FullNameField = () => {\n *     const record = useRecordContext();\n *     return (<span>{record.first_name} {record.last_name}</span>)\n * };\n * <SelectArrayInput source=\"authors\" choices={choices} optionText={<FullNameField />}/>\n *\n * The choices are translated by default, so you can use translation identifiers as choices:\n * @example\n * const choices = [\n *    { id: 'programming', name: 'myroot.tags.programming' },\n *    { id: 'lifestyle', name: 'myroot.tags.lifestyle' },\n *    { id: 'photography', name: 'myroot.tags.photography' },\n * ];\n */\nexport var SelectArrayInput = function SelectArrayInput(props) {\n  var choicesProp = props.choices,\n    className = props.className,\n    create = props.create,\n    createLabel = props.createLabel,\n    createValue = props.createValue,\n    disableValue = props.disableValue,\n    format = props.format,\n    helperText = props.helperText,\n    label = props.label,\n    isFetchingProp = props.isFetching,\n    isLoadingProp = props.isLoading,\n    margin = props.margin,\n    onBlur = props.onBlur,\n    onChange = props.onChange,\n    onCreate = props.onCreate,\n    options = props.options,\n    optionText = props.optionText,\n    optionValue = props.optionValue,\n    parse = props.parse,\n    resourceProp = props.resource,\n    sourceProp = props.source,\n    translateChoice = props.translateChoice,\n    validate = props.validate,\n    variant = props.variant,\n    rest = __rest(props, [\"choices\", \"className\", \"create\", \"createLabel\", \"createValue\", \"disableValue\", \"format\", \"helperText\", \"label\", \"isFetching\", \"isLoading\", \"margin\", \"onBlur\", \"onChange\", \"onCreate\", \"options\", \"optionText\", \"optionValue\", \"parse\", \"resource\", \"source\", \"translateChoice\", \"validate\", \"variant\"]);\n  var inputLabel = useRef(null);\n  var _a = useChoicesContext({\n      choices: choicesProp,\n      isLoading: isLoadingProp,\n      isFetching: isFetchingProp,\n      resource: resourceProp,\n      source: sourceProp\n    }),\n    allChoices = _a.allChoices,\n    isLoading = _a.isLoading,\n    fetchError = _a.error,\n    source = _a.source,\n    resource = _a.resource;\n  var _b = useChoices({\n      optionText: optionText,\n      optionValue: optionValue,\n      disableValue: disableValue,\n      translateChoice: translateChoice\n    }),\n    getChoiceText = _b.getChoiceText,\n    getChoiceValue = _b.getChoiceValue,\n    getDisableValue = _b.getDisableValue;\n  var _c = useInput(__assign({\n      format: format,\n      onBlur: onBlur,\n      onChange: onChange,\n      parse: parse,\n      resource: resource,\n      source: source,\n      validate: validate\n    }, rest)),\n    field = _c.field,\n    isRequired = _c.isRequired,\n    _d = _c.fieldState,\n    error = _d.error,\n    invalid = _d.invalid,\n    isTouched = _d.isTouched,\n    isSubmitted = _c.formState.isSubmitted;\n  var handleChange = useCallback(function (eventOrChoice) {\n    // We might receive an event from the mui component\n    // In this case, it will be the choice id\n    if (eventOrChoice === null || eventOrChoice === void 0 ? void 0 : eventOrChoice.target) {\n      field.onChange(eventOrChoice);\n    } else {\n      // Or we might receive a choice directly, for instance a newly created one\n      field.onChange(__spreadArray(__spreadArray([], field.value || [], true), [getChoiceValue(eventOrChoice)], false));\n    }\n  }, [field, getChoiceValue]);\n  var _e = useSupportCreateSuggestion({\n      create: create,\n      createLabel: createLabel,\n      createValue: createValue,\n      handleChange: handleChange,\n      onCreate: onCreate,\n      optionText: optionText\n    }),\n    getCreateItem = _e.getCreateItem,\n    handleChangeWithCreateSupport = _e.handleChange,\n    createElement = _e.createElement;\n  var createItem = create || onCreate ? getCreateItem() : null;\n  var finalChoices = create || onCreate ? __spreadArray(__spreadArray([], allChoices || [], true), [createItem], false) : allChoices || [];\n  var renderMenuItemOption = useCallback(function (choice) {\n    return !!createItem && (choice === null || choice === void 0 ? void 0 : choice.id) === createItem.id && typeof optionText === 'function' ? createItem.name : getChoiceText(choice);\n  }, [createItem, getChoiceText, optionText]);\n  var renderMenuItem = useCallback(function (choice) {\n    return choice ? React.createElement(MenuItem, {\n      key: getChoiceValue(choice),\n      value: getChoiceValue(choice),\n      disabled: getDisableValue(choice)\n    }, renderMenuItemOption(!!createItem && (choice === null || choice === void 0 ? void 0 : choice.id) === createItem.id ? createItem : choice)) : null;\n  }, [getChoiceValue, getDisableValue, renderMenuItemOption, createItem]);\n  if (isLoading) {\n    return React.createElement(Labeled, {\n      label: label,\n      source: source,\n      resource: resource,\n      className: clsx('ra-input', \"ra-input-\".concat(source), className),\n      isRequired: isRequired\n    }, React.createElement(LinearProgress, null));\n  }\n  return React.createElement(React.Fragment, null, React.createElement(StyledFormControl, __assign({\n    margin: margin,\n    className: clsx('ra-input', \"ra-input-\".concat(source), className),\n    error: fetchError || (isTouched || isSubmitted) && invalid,\n    variant: variant\n  }, sanitizeRestProps(rest)), React.createElement(InputLabel, {\n    ref: inputLabel,\n    id: \"\".concat(label, \"-outlined-label\")\n  }, React.createElement(FieldTitle, {\n    label: label,\n    source: source,\n    resource: resource,\n    isRequired: isRequired\n  })), React.createElement(Select, __assign({\n    autoWidth: true,\n    labelId: \"\".concat(label, \"-outlined-label\"),\n    multiple: true,\n    error: !!fetchError || (isTouched || isSubmitted) && invalid,\n    renderValue: function renderValue(selected) {\n      return React.createElement(\"div\", {\n        className: SelectArrayInputClasses.chips\n      }, selected.map(function (item) {\n        return (allChoices || []).find(function (choice) {\n          return getChoiceValue(choice) === item;\n        });\n      }).filter(function (item) {\n        return !!item;\n      }).map(function (item) {\n        return React.createElement(Chip, {\n          key: getChoiceValue(item),\n          label: renderMenuItemOption(item),\n          className: SelectArrayInputClasses.chip,\n          size: \"small\"\n        });\n      }));\n    },\n    \"data-testid\": \"selectArray\",\n    size: \"small\"\n  }, field, options, {\n    onChange: handleChangeWithCreateSupport,\n    value: field.value || []\n  }), finalChoices.map(renderMenuItem)), React.createElement(FormHelperText, {\n    error: fetchError || isTouched && !!error\n  }, React.createElement(InputHelperText, {\n    touched: isTouched || isSubmitted || fetchError,\n    error: (error === null || error === void 0 ? void 0 : error.message) || (fetchError === null || fetchError === void 0 ? void 0 : fetchError.message),\n    helperText: helperText\n  }))), createElement);\n};\nSelectArrayInput.propTypes = {\n  choices: PropTypes.arrayOf(PropTypes.object),\n  className: PropTypes.string,\n  children: PropTypes.node,\n  label: PropTypes.oneOfType([PropTypes.string, PropTypes.bool, PropTypes.element]),\n  options: PropTypes.object,\n  optionText: PropTypes.oneOfType([PropTypes.string, PropTypes.func, PropTypes.element]).isRequired,\n  optionValue: PropTypes.string.isRequired,\n  disableValue: PropTypes.string,\n  resource: PropTypes.string,\n  source: PropTypes.string,\n  translateChoice: PropTypes.bool\n};\nSelectArrayInput.defaultProps = {\n  options: {},\n  optionText: 'name',\n  optionValue: 'id',\n  disableValue: 'disabled',\n  translateChoice: true\n};\nvar sanitizeRestProps = function sanitizeRestProps(_a) {\n  var alwaysOn = _a.alwaysOn,\n    choices = _a.choices,\n    classNamInputWithOptionsPropse = _a.classNamInputWithOptionsPropse,\n    componenInputWithOptionsPropst = _a.componenInputWithOptionsPropst,\n    crudGetMInputWithOptionsPropsatching = _a.crudGetMInputWithOptionsPropsatching,\n    crudGetOInputWithOptionsPropsne = _a.crudGetOInputWithOptionsPropsne,\n    defaultValue = _a.defaultValue,\n    disableValue = _a.disableValue,\n    emptyText = _a.emptyText,\n    enableGetChoices = _a.enableGetChoices,\n    filter = _a.filter,\n    filterToQuery = _a.filterToQuery,\n    formClassName = _a.formClassName,\n    initializeForm = _a.initializeForm,\n    initialValue = _a.initialValue,\n    input = _a.input,\n    isRequired = _a.isRequired,\n    label = _a.label,\n    limitChoicesToValue = _a.limitChoicesToValue,\n    loaded = _a.loaded,\n    locale = _a.locale,\n    meta = _a.meta,\n    onChange = _a.onChange,\n    options = _a.options,\n    optionValue = _a.optionValue,\n    optionText = _a.optionText,\n    perPage = _a.perPage,\n    record = _a.record,\n    reference = _a.reference,\n    resource = _a.resource,\n    setFilter = _a.setFilter,\n    setPagination = _a.setPagination,\n    setSort = _a.setSort,\n    sort = _a.sort,\n    source = _a.source,\n    textAlign = _a.textAlign,\n    translate = _a.translate,\n    translateChoice = _a.translateChoice,\n    validation = _a.validation,\n    rest = __rest(_a, [\"alwaysOn\", \"choices\", \"classNamInputWithOptionsPropse\", \"componenInputWithOptionsPropst\", \"crudGetMInputWithOptionsPropsatching\", \"crudGetOInputWithOptionsPropsne\", \"defaultValue\", \"disableValue\", \"emptyText\", \"enableGetChoices\", \"filter\", \"filterToQuery\", \"formClassName\", \"initializeForm\", \"initialValue\", \"input\", \"isRequired\", \"label\", \"limitChoicesToValue\", \"loaded\", \"locale\", \"meta\", \"onChange\", \"options\", \"optionValue\", \"optionText\", \"perPage\", \"record\", \"reference\", \"resource\", \"setFilter\", \"setPagination\", \"setSort\", \"sort\", \"source\", \"textAlign\", \"translate\", \"translateChoice\", \"validation\"]);\n  return rest;\n};\nvar PREFIX = 'RaSelectArrayInput';\nexport var SelectArrayInputClasses = {\n  chips: \"\".concat(PREFIX, \"-chips\"),\n  chip: \"\".concat(PREFIX, \"-chip\")\n};\nvar StyledFormControl = styled(FormControl, {\n  name: PREFIX,\n  overridesResolver: function overridesResolver(props, styles) {\n    return styles.root;\n  }\n})(function (_a) {\n  var _b;\n  var theme = _a.theme;\n  return _b = {\n    minWidth: theme.spacing(20)\n  }, _b[\"& .\".concat(SelectArrayInputClasses.chips)] = {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }, _b[\"& .\".concat(SelectArrayInputClasses.chip)] = {\n    marginTop: theme.spacing(0.5),\n    marginRight: theme.spacing(0.5)\n  }, _b;\n});","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,SAASC,MAAM,QAAQ,sBAAsB;AAC7C,SAASC,WAAW,EAAEC,MAAM,QAAqB,OAAO;AACxD,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,IAAI,MAAM,MAAM;AACvB,SACIC,MAAM,EAENC,QAAQ,EACRC,UAAU,EACVC,cAAc,EACdC,WAAW,EACXC,IAAI,QACD,eAAe;AACtB,SAEIC,UAAU,EACVC,QAAQ,EACRC,iBAAiB,EACjBC,UAAU,QAEP,SAAS;AAChB,SAASC,eAAe,QAAQ,mBAAmB;AAGnD,SAASC,cAAc,QAAQ,WAAW;AAE1C,SAASC,OAAO,QAAQ,YAAY;AACpC,SAEIC,0BAA0B,QACvB,8BAA8B;AAErC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuDA,OAAO,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAgB,CAAIC,KAA4B;EAErD,IAASC,WAAW,GAyBpBD,KAAK,QAzBe;IACpBE,SAAS,GAwBTF,KAAK,UAxBI;IACTG,MAAM,GAuBNH,KAAK,OAvBC;IACNI,WAAW,GAsBXJ,KAAK,YAtBM;IACXK,WAAW,GAqBXL,KAAK,YArBM;IACXM,YAAY,GAoBZN,KAAK,aApBO;IACZO,MAAM,GAmBNP,KAAK,OAnBC;IACNQ,UAAU,GAkBVR,KAAK,WAlBK;IACVS,KAAK,GAiBLT,KAAK,MAjBA;IACOU,cAAc,GAgB1BV,KAAK,WAhBqB;IACfW,aAAa,GAexBX,KAAK,UAfmB;IACxBY,MAAM,GAcNZ,KAAK,OAdC;IACNa,MAAM,GAaNb,KAAK,OAbC;IACNc,QAAQ,GAYRd,KAAK,SAZG;IACRe,QAAQ,GAWRf,KAAK,SAXG;IACRgB,OAAO,GAUPhB,KAAK,QAVE;IACPiB,UAAU,GASVjB,KAAK,WATK;IACVkB,WAAW,GAQXlB,KAAK,YARM;IACXmB,KAAK,GAOLnB,KAAK,MAPA;IACKoB,YAAY,GAMtBpB,KAAK,SANiB;IACdqB,UAAU,GAKlBrB,KAAK,OALa;IAClBsB,eAAe,GAIftB,KAAK,gBAJU;IACfuB,QAAQ,GAGRvB,KAAK,SAHG;IACRwB,OAAO,GAEPxB,KAAK,QAFE;IACJyB,IAAI,UACPzB,KAAK,EA1BH,ySA0BL,CADU;EAGX,IAAM0B,UAAU,GAAG5C,MAAM,CAAC,IAAI,CAAC;EAEzB,SAMFW,iBAAiB,CAAC;MAClBkC,OAAO,EAAE1B,WAAW;MACpB2B,SAAS,EAAEjB,aAAa;MACxBkB,UAAU,EAAEnB,cAAc;MAC1BoB,QAAQ,EAAEV,YAAY;MACtBW,MAAM,EAAEV;KACX,CAAC;IAXEW,UAAU;IACVJ,SAAS;IACFK,UAAU;IACjBF,MAAM;IACND,QAAQ,cAOV;EAEI,SAAqDpC,UAAU,CAAC;MAClEuB,UAAU;MACVC,WAAW;MACXZ,YAAY;MACZgB,eAAe;KAClB,CAAC;IALMY,aAAa;IAAEC,cAAc;IAAEC,eAAe,qBAKpD;EAEI,SAKF5C,QAAQ;MACRe,MAAM;MACNM,MAAM;MACNC,QAAQ;MACRK,KAAK;MACLW,QAAQ;MACRC,MAAM;MACNR,QAAQ;IAAA,GACLE,IAAI,EACT;IAbEY,KAAK;IACLC,UAAU;IACVC,kBAAyC;IAA3BC,KAAK;IAAEC,OAAO;IAAEC,SAAS;IAC1BC,WAAW,2BAU1B;EAEF,IAAMC,YAAY,GAAG/D,WAAW,CAC5B,UAACgE,aAAuD;IACpD;IACA;IACA,IAAIA,aAAa,aAAbA,aAAa,uBAAbA,aAAa,CAAEC,MAAM,EAAE;MACvBT,KAAK,CAACvB,QAAQ,CAAC+B,aAAa,CAAC;KAChC,MAAM;MACH;MACAR,KAAK,CAACvB,QAAQ,iCACNuB,KAAK,CAACU,KAAK,IAAI,EAAE,EAAC,QACtBZ,cAAc,CAACU,aAAa,CAAC,UAC/B;;EAEV,CAAC,EACD,CAACR,KAAK,EAAEF,cAAc,CAAC,CAC1B;EAEK,SAIFrC,0BAA0B,CAAC;MAC3BK,MAAM;MACNC,WAAW;MACXC,WAAW;MACXuC,YAAY;MACZ7B,QAAQ;MACRE,UAAU;KACb,CAAC;IAVE+B,aAAa;IACCC,6BAA6B;IAC3CC,aAAa,mBAQf;EAEF,IAAMC,UAAU,GAAGhD,MAAM,IAAIY,QAAQ,GAAGiC,aAAa,EAAE,GAAG,IAAI;EAC9D,IAAMI,YAAY,GACdjD,MAAM,IAAIY,QAAQ,GACbsC,gCAAMrB,UAAU,IAAI,EAAE,EAAC,QAAEmB,UAAU,YAClCnB,UAAU,IAAI,EAAE;EAE1B,IAAMsB,oBAAoB,GAAGzE,WAAW,CACpC,gBAAM;IACF,QAAC,CAACsE,UAAU,IACZ,OAAM,aAANI,MAAM,uBAANA,MAAM,CAAEC,EAAE,MAAKL,UAAU,CAACK,EAAE,IAC5B,OAAOvC,UAAU,KAAK,UAAU,GAC1BkC,UAAU,CAACM,IAAI,GACfvB,aAAa,CAACqB,MAAM,CAAC;EAJ3B,CAI2B,EAC/B,CAACJ,UAAU,EAAEjB,aAAa,EAAEjB,UAAU,CAAC,CAC1C;EAED,IAAMyC,cAAc,GAAG7E,WAAW,CAC9B,gBAAM;IACF,OAAO0E,MAAM,GACT5E,oBAACO,QAAQ;MACLyE,GAAG,EAAExB,cAAc,CAACoB,MAAM,CAAC;MAC3BR,KAAK,EAAEZ,cAAc,CAACoB,MAAM,CAAC;MAC7BK,QAAQ,EAAExB,eAAe,CAACmB,MAAM;IAAC,GAEhCD,oBAAoB,CACjB,CAAC,CAACH,UAAU,IAAI,OAAM,aAANI,MAAM,uBAANA,MAAM,CAAEC,EAAE,MAAKL,UAAU,CAACK,EAAE,GACtCL,UAAU,GACVI,MAAM,CACf,CACM,GACX,IAAI;EACZ,CAAC,EACD,CAACpB,cAAc,EAAEC,eAAe,EAAEkB,oBAAoB,EAAEH,UAAU,CAAC,CACtE;EAED,IAAIvB,SAAS,EAAE;IACX,OACIjD,oBAACkB,OAAO;MACJY,KAAK,EAAEA,KAAK;MACZsB,MAAM,EAAEA,MAAM;MACdD,QAAQ,EAAEA,QAAQ;MAClB5B,SAAS,EAAElB,IAAI,CAAC,UAAU,EAAE,mBAAY+C,MAAM,CAAE,EAAE7B,SAAS,CAAC;MAC5DoC,UAAU,EAAEA;IAAU,GAEtB3D,oBAACiB,cAAc,OAAG,CACZ;;EAIlB,OACIjB,0CACIA,oBAACkF,iBAAiB;IACdjD,MAAM,EAAEA,MAAM;IACdV,SAAS,EAAElB,IAAI,CAAC,UAAU,EAAE,mBAAY+C,MAAM,CAAE,EAAE7B,SAAS,CAAC;IAC5DsC,KAAK,EAAEP,UAAU,IAAK,CAACS,SAAS,IAAIC,WAAW,KAAKF,OAAQ;IAC5DjB,OAAO,EAAEA;EAAO,GACZsC,iBAAiB,CAACrC,IAAI,CAAC,GAE3B9C,oBAACQ,UAAU;IAAC4E,GAAG,EAAErC,UAAU;IAAE8B,EAAE,EAAE,UAAG/C,KAAK;EAAiB,GACtD9B,oBAACY,UAAU;IACPkB,KAAK,EAAEA,KAAK;IACZsB,MAAM,EAAEA,MAAM;IACdD,QAAQ,EAAEA,QAAQ;IAClBQ,UAAU,EAAEA;EAAU,EACxB,CACO,EACb3D,oBAACM,MAAM;IACH+E,SAAS;IACTC,OAAO,EAAE,UAAGxD,KAAK,oBAAiB;IAClCyD,QAAQ;IACR1B,KAAK,EACD,CAAC,CAACP,UAAU,IAAK,CAACS,SAAS,IAAIC,WAAW,KAAKF,OAAQ;IAE3D0B,WAAW,EAAE,qBAACC,QAAe;MAAK,OAC9BzF;QAAKuB,SAAS,EAAEmE,uBAAuB,CAACC;MAAK,GACxCF,QAAQ,CACJG,GAAG,CAAC,cAAI;QACL,QAACvC,UAAU,IAAI,EAAE,EAAEwC,IAAI,CACnB,gBAAM;UACF,qBAAc,CAACjB,MAAM,CAAC,KAAKkB,IAAI;QAA/B,CAA+B,CACtC;MAHD,CAGC,CACJ,CACAC,MAAM,CAAC,cAAI;QAAI,QAAC,CAACD,IAAI;MAAN,CAAM,CAAC,CACtBF,GAAG,CAAC,cAAI;QAAI,OACT5F,oBAACW,IAAI;UACDqE,GAAG,EAAExB,cAAc,CAACsC,IAAI,CAAC;UACzBhE,KAAK,EAAE6C,oBAAoB,CAACmB,IAAI,CAAC;UACjCvE,SAAS,EAAEmE,uBAAuB,CAACM,IAAI;UACvCC,IAAI,EAAC;QAAO,EACd;MANO,CAOZ,CAAC,CACJ;IAlBwB,CAmBjC;IAAA,eACW,aAAa;IACzBA,IAAI,EAAC;EAAO,GACRvC,KAAK,EACLrB,OAAO;IACXF,QAAQ,EAAEmC,6BAA6B;IACvCF,KAAK,EAAEV,KAAK,CAACU,KAAK,IAAI;EAAE,IAEvBK,YAAY,CAACmB,GAAG,CAACb,cAAc,CAAC,CAC5B,EACT/E,oBAACS,cAAc;IAACoD,KAAK,EAAEP,UAAU,IAAKS,SAAS,IAAI,CAAC,CAACF;EAAM,GACvD7D,oBAACgB,eAAe;IACZkF,OAAO,EAAEnC,SAAS,IAAIC,WAAW,IAAIV,UAAU;IAC/CO,KAAK,EAAE,MAAK,aAALA,KAAK,uBAALA,KAAK,CAAEsC,OAAO,MAAI7C,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAE6C,OAAO;IAC5CtE,UAAU,EAAEA;EAAU,EACxB,CACW,CACD,EACnB0C,aAAa,CACf;AAEX,CAAC;AAYDnD,gBAAgB,CAACgF,SAAS,GAAG;EACzBpD,OAAO,EAAE5C,SAAS,CAACiG,OAAO,CAACjG,SAAS,CAACkG,MAAM,CAAC;EAC5C/E,SAAS,EAAEnB,SAAS,CAACmG,MAAM;EAC3BC,QAAQ,EAAEpG,SAAS,CAACqG,IAAI;EACxB3E,KAAK,EAAE1B,SAAS,CAACsG,SAAS,CAAC,CACvBtG,SAAS,CAACmG,MAAM,EAChBnG,SAAS,CAACuG,IAAI,EACdvG,SAAS,CAACwG,OAAO,CACpB,CAAC;EACFvE,OAAO,EAAEjC,SAAS,CAACkG,MAAM;EACzBhE,UAAU,EAAElC,SAAS,CAACsG,SAAS,CAAC,CAC5BtG,SAAS,CAACmG,MAAM,EAChBnG,SAAS,CAACyG,IAAI,EACdzG,SAAS,CAACwG,OAAO,CACpB,CAAC,CAACjD,UAAU;EACbpB,WAAW,EAAEnC,SAAS,CAACmG,MAAM,CAAC5C,UAAU;EACxChC,YAAY,EAAEvB,SAAS,CAACmG,MAAM;EAC9BpD,QAAQ,EAAE/C,SAAS,CAACmG,MAAM;EAC1BnD,MAAM,EAAEhD,SAAS,CAACmG,MAAM;EACxB5D,eAAe,EAAEvC,SAAS,CAACuG;CAC9B;AAEDvF,gBAAgB,CAAC0F,YAAY,GAAG;EAC5BzE,OAAO,EAAE,EAAE;EACXC,UAAU,EAAE,MAAM;EAClBC,WAAW,EAAE,IAAI;EACjBZ,YAAY,EAAE,UAAU;EACxBgB,eAAe,EAAE;CACpB;AAED,IAAMwC,iBAAiB,GAAG,SAApBA,iBAAiB,CAAI4B,EAyCrB;EAxCF,YAAQ;IACR/D,OAAO;IACPgE,8BAA8B;IAC9BC,8BAA8B;IAC9BC,oCAAoC;IACpCC,+BAA+B;IAC/BC,YAAY;IACZzF,YAAY;IACZ0F,SAAS;IACTC,gBAAgB;IAChBvB,MAAM;IACNwB,aAAa;IACbC,aAAa;IACbC,cAAc;IACdC,YAAY;IACZC,KAAK;IACLhE,UAAU;IACV7B,KAAK;IACL8F,mBAAmB;IACnBC,MAAM;IACNC,MAAM;IACNC,IAAI;IACJ5F,QAAQ;IACRE,OAAO;IACPE,WAAW;IACXD,UAAU;IACV0F,OAAO;IACPC,MAAM;IACNC,SAAS;IACT/E,QAAQ;IACRgF,SAAS;IACTC,aAAa;IACbC,OAAO;IACPC,IAAI;IACJlF,MAAM;IACNmF,SAAS;IACTC,SAAS;IACT7F,eAAe;IACf8F,UAAU;IACP3F,IAAI,cAxCgB,gmBAyC1B,CADU;EACA,WAAI;CAAA;AAEf,IAAM4F,MAAM,GAAG,oBAAoB;AAEnC,OAAO,IAAMhD,uBAAuB,GAAG;EACnCC,KAAK,EAAE,UAAG+C,MAAM,WAAQ;EACxB1C,IAAI,EAAE,UAAG0C,MAAM;CAClB;AAED,IAAMxD,iBAAiB,GAAGjF,MAAM,CAACS,WAAW,EAAE;EAC1CoE,IAAI,EAAE4D,MAAM;EACZC,iBAAiB,EAAE,2BAACtH,KAAK,EAAEuH,MAAM;IAAK,aAAM,CAACC,IAAI;EAAX;CACzC,CAAC,CAAC,UAAC9B,EAAS;;MAAP+B,KAAK;EAAO;IACdC,QAAQ,EAAED,KAAK,CAACE,OAAO,CAAC,EAAE;KAC1BC,GAAC,aAAMvD,uBAAuB,CAACC,KAAK,CAAE,IAAG;IACrCuD,OAAO,EAAE,MAAM;IACfC,QAAQ,EAAE;GACb,EAEDF,GAAC,aAAMvD,uBAAuB,CAACM,IAAI,CAAE,IAAG;IACpCoD,SAAS,EAAEN,KAAK,CAACE,OAAO,CAAC,GAAG,CAAC;IAC7BK,WAAW,EAAEP,KAAK,CAACE,OAAO,CAAC,GAAG;GACjC;AAVa,CAWhB,CAAC","names":["React","styled","useCallback","useRef","PropTypes","clsx","Select","MenuItem","InputLabel","FormHelperText","FormControl","Chip","FieldTitle","useInput","useChoicesContext","useChoices","InputHelperText","LinearProgress","Labeled","useSupportCreateSuggestion","SelectArrayInput","props","choicesProp","className","create","createLabel","createValue","disableValue","format","helperText","label","isFetchingProp","isLoadingProp","margin","onBlur","onChange","onCreate","options","optionText","optionValue","parse","resourceProp","sourceProp","translateChoice","validate","variant","rest","inputLabel","choices","isLoading","isFetching","resource","source","allChoices","fetchError","getChoiceText","getChoiceValue","getDisableValue","field","isRequired","_d","error","invalid","isTouched","isSubmitted","handleChange","eventOrChoice","target","value","getCreateItem","handleChangeWithCreateSupport","createElement","createItem","finalChoices","__spreadArray","renderMenuItemOption","choice","id","name","renderMenuItem","key","disabled","StyledFormControl","sanitizeRestProps","ref","autoWidth","labelId","multiple","renderValue","selected","SelectArrayInputClasses","chips","map","find","item","filter","chip","size","touched","message","propTypes","arrayOf","object","string","children","node","oneOfType","bool","element","func","defaultProps","_a","classNamInputWithOptionsPropse","componenInputWithOptionsPropst","crudGetMInputWithOptionsPropsatching","crudGetOInputWithOptionsPropsne","defaultValue","emptyText","enableGetChoices","filterToQuery","formClassName","initializeForm","initialValue","input","limitChoicesToValue","loaded","locale","meta","perPage","record","reference","setFilter","setPagination","setSort","sort","textAlign","translate","validation","PREFIX","overridesResolver","styles","root","theme","minWidth","spacing","_b","display","flexWrap","marginTop","marginRight"],"sources":["/Users/jjun/design_system/node_modules/ra-ui-materialui/src/input/SelectArrayInput.tsx"],"sourcesContent":["import * as React from 'react';\nimport { styled } from '@mui/material/styles';\nimport { useCallback, useRef, ChangeEvent } from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport {\n    Select,\n    SelectProps,\n    MenuItem,\n    InputLabel,\n    FormHelperText,\n    FormControl,\n    Chip,\n} from '@mui/material';\nimport {\n    ChoicesProps,\n    FieldTitle,\n    useInput,\n    useChoicesContext,\n    useChoices,\n    RaRecord,\n} from 'ra-core';\nimport { InputHelperText } from './InputHelperText';\nimport { FormControlProps } from '@mui/material/FormControl';\n\nimport { LinearProgress } from '../layout';\nimport { CommonInputProps } from './CommonInputProps';\nimport { Labeled } from '../Labeled';\nimport {\n    SupportCreateSuggestionOptions,\n    useSupportCreateSuggestion,\n} from './useSupportCreateSuggestion';\n\n/**\n * An Input component for a select box allowing multiple selections, using an array of objects for the options\n *\n * Pass possible options as an array of objects in the 'choices' attribute.\n *\n * By default, the options are built from:\n *  - the 'id' property as the option value,\n *  - the 'name' property as the option text\n * @example\n * const choices = [\n *    { id: 'programming', name: 'Programming' },\n *    { id: 'lifestyle', name: 'Lifestyle' },\n *    { id: 'photography', name: 'Photography' },\n * ];\n * <SelectArrayInput source=\"tags\" choices={choices} />\n *\n * You can also customize the properties to use for the option name and value,\n * thanks to the 'optionText' and 'optionValue' attributes.\n * @example\n * const choices = [\n *    { _id: 123, full_name: 'Leo Tolstoi', sex: 'M' },\n *    { _id: 456, full_name: 'Jane Austen', sex: 'F' },\n * ];\n * <SelectArrayInput source=\"authors\" choices={choices} optionText=\"full_name\" optionValue=\"_id\" />\n *\n * `optionText` also accepts a function, so you can shape the option text at will:\n * @example\n * const choices = [\n *    { id: 123, first_name: 'Leo', last_name: 'Tolstoi' },\n *    { id: 456, first_name: 'Jane', last_name: 'Austen' },\n * ];\n * const optionRenderer = choice => `${choice.first_name} ${choice.last_name}`;\n * <SelectArrayInput source=\"authors\" choices={choices} optionText={optionRenderer} />\n *\n * `optionText` also accepts a React Element, that can access\n * the related choice through the `useRecordContext` hook. You can use Field components there.\n * @example\n * const choices = [\n *    { id: 123, first_name: 'Leo', last_name: 'Tolstoi' },\n *    { id: 456, first_name: 'Jane', last_name: 'Austen' },\n * ];\n * const FullNameField = () => {\n *     const record = useRecordContext();\n *     return (<span>{record.first_name} {record.last_name}</span>)\n * };\n * <SelectArrayInput source=\"authors\" choices={choices} optionText={<FullNameField />}/>\n *\n * The choices are translated by default, so you can use translation identifiers as choices:\n * @example\n * const choices = [\n *    { id: 'programming', name: 'myroot.tags.programming' },\n *    { id: 'lifestyle', name: 'myroot.tags.lifestyle' },\n *    { id: 'photography', name: 'myroot.tags.photography' },\n * ];\n */\nexport const SelectArrayInput = (props: SelectArrayInputProps) => {\n    const {\n        choices: choicesProp,\n        className,\n        create,\n        createLabel,\n        createValue,\n        disableValue,\n        format,\n        helperText,\n        label,\n        isFetching: isFetchingProp,\n        isLoading: isLoadingProp,\n        margin,\n        onBlur,\n        onChange,\n        onCreate,\n        options,\n        optionText,\n        optionValue,\n        parse,\n        resource: resourceProp,\n        source: sourceProp,\n        translateChoice,\n        validate,\n        variant,\n        ...rest\n    } = props;\n\n    const inputLabel = useRef(null);\n\n    const {\n        allChoices,\n        isLoading,\n        error: fetchError,\n        source,\n        resource,\n    } = useChoicesContext({\n        choices: choicesProp,\n        isLoading: isLoadingProp,\n        isFetching: isFetchingProp,\n        resource: resourceProp,\n        source: sourceProp,\n    });\n\n    const { getChoiceText, getChoiceValue, getDisableValue } = useChoices({\n        optionText,\n        optionValue,\n        disableValue,\n        translateChoice,\n    });\n\n    const {\n        field,\n        isRequired,\n        fieldState: { error, invalid, isTouched },\n        formState: { isSubmitted },\n    } = useInput({\n        format,\n        onBlur,\n        onChange,\n        parse,\n        resource,\n        source,\n        validate,\n        ...rest,\n    });\n\n    const handleChange = useCallback(\n        (eventOrChoice: ChangeEvent<HTMLInputElement> | RaRecord) => {\n            // We might receive an event from the mui component\n            // In this case, it will be the choice id\n            if (eventOrChoice?.target) {\n                field.onChange(eventOrChoice);\n            } else {\n                // Or we might receive a choice directly, for instance a newly created one\n                field.onChange([\n                    ...(field.value || []),\n                    getChoiceValue(eventOrChoice),\n                ]);\n            }\n        },\n        [field, getChoiceValue]\n    );\n\n    const {\n        getCreateItem,\n        handleChange: handleChangeWithCreateSupport,\n        createElement,\n    } = useSupportCreateSuggestion({\n        create,\n        createLabel,\n        createValue,\n        handleChange,\n        onCreate,\n        optionText,\n    });\n\n    const createItem = create || onCreate ? getCreateItem() : null;\n    const finalChoices =\n        create || onCreate\n            ? [...(allChoices || []), createItem]\n            : allChoices || [];\n\n    const renderMenuItemOption = useCallback(\n        choice =>\n            !!createItem &&\n            choice?.id === createItem.id &&\n            typeof optionText === 'function'\n                ? createItem.name\n                : getChoiceText(choice),\n        [createItem, getChoiceText, optionText]\n    );\n\n    const renderMenuItem = useCallback(\n        choice => {\n            return choice ? (\n                <MenuItem\n                    key={getChoiceValue(choice)}\n                    value={getChoiceValue(choice)}\n                    disabled={getDisableValue(choice)}\n                >\n                    {renderMenuItemOption(\n                        !!createItem && choice?.id === createItem.id\n                            ? createItem\n                            : choice\n                    )}\n                </MenuItem>\n            ) : null;\n        },\n        [getChoiceValue, getDisableValue, renderMenuItemOption, createItem]\n    );\n\n    if (isLoading) {\n        return (\n            <Labeled\n                label={label}\n                source={source}\n                resource={resource}\n                className={clsx('ra-input', `ra-input-${source}`, className)}\n                isRequired={isRequired}\n            >\n                <LinearProgress />\n            </Labeled>\n        );\n    }\n\n    return (\n        <>\n            <StyledFormControl\n                margin={margin}\n                className={clsx('ra-input', `ra-input-${source}`, className)}\n                error={fetchError || ((isTouched || isSubmitted) && invalid)}\n                variant={variant}\n                {...sanitizeRestProps(rest)}\n            >\n                <InputLabel ref={inputLabel} id={`${label}-outlined-label`}>\n                    <FieldTitle\n                        label={label}\n                        source={source}\n                        resource={resource}\n                        isRequired={isRequired}\n                    />\n                </InputLabel>\n                <Select\n                    autoWidth\n                    labelId={`${label}-outlined-label`}\n                    multiple\n                    error={\n                        !!fetchError || ((isTouched || isSubmitted) && invalid)\n                    }\n                    renderValue={(selected: any[]) => (\n                        <div className={SelectArrayInputClasses.chips}>\n                            {selected\n                                .map(item =>\n                                    (allChoices || []).find(\n                                        choice =>\n                                            getChoiceValue(choice) === item\n                                    )\n                                )\n                                .filter(item => !!item)\n                                .map(item => (\n                                    <Chip\n                                        key={getChoiceValue(item)}\n                                        label={renderMenuItemOption(item)}\n                                        className={SelectArrayInputClasses.chip}\n                                        size=\"small\"\n                                    />\n                                ))}\n                        </div>\n                    )}\n                    data-testid=\"selectArray\"\n                    size=\"small\"\n                    {...field}\n                    {...options}\n                    onChange={handleChangeWithCreateSupport}\n                    value={field.value || []}\n                >\n                    {finalChoices.map(renderMenuItem)}\n                </Select>\n                <FormHelperText error={fetchError || (isTouched && !!error)}>\n                    <InputHelperText\n                        touched={isTouched || isSubmitted || fetchError}\n                        error={error?.message || fetchError?.message}\n                        helperText={helperText}\n                    />\n                </FormHelperText>\n            </StyledFormControl>\n            {createElement}\n        </>\n    );\n};\n\nexport type SelectArrayInputProps = ChoicesProps &\n    Omit<SupportCreateSuggestionOptions, 'handleChange'> &\n    Omit<CommonInputProps, 'source'> &\n    Omit<FormControlProps, 'defaultValue' | 'onBlur' | 'onChange'> & {\n        options?: SelectProps;\n        disableValue?: string;\n        source?: string;\n        onChange?: (event: ChangeEvent<HTMLInputElement> | RaRecord) => void;\n    };\n\nSelectArrayInput.propTypes = {\n    choices: PropTypes.arrayOf(PropTypes.object),\n    className: PropTypes.string,\n    children: PropTypes.node,\n    label: PropTypes.oneOfType([\n        PropTypes.string,\n        PropTypes.bool,\n        PropTypes.element,\n    ]),\n    options: PropTypes.object,\n    optionText: PropTypes.oneOfType([\n        PropTypes.string,\n        PropTypes.func,\n        PropTypes.element,\n    ]).isRequired,\n    optionValue: PropTypes.string.isRequired,\n    disableValue: PropTypes.string,\n    resource: PropTypes.string,\n    source: PropTypes.string,\n    translateChoice: PropTypes.bool,\n};\n\nSelectArrayInput.defaultProps = {\n    options: {},\n    optionText: 'name',\n    optionValue: 'id',\n    disableValue: 'disabled',\n    translateChoice: true,\n};\n\nconst sanitizeRestProps = ({\n    alwaysOn,\n    choices,\n    classNamInputWithOptionsPropse,\n    componenInputWithOptionsPropst,\n    crudGetMInputWithOptionsPropsatching,\n    crudGetOInputWithOptionsPropsne,\n    defaultValue,\n    disableValue,\n    emptyText,\n    enableGetChoices,\n    filter,\n    filterToQuery,\n    formClassName,\n    initializeForm,\n    initialValue,\n    input,\n    isRequired,\n    label,\n    limitChoicesToValue,\n    loaded,\n    locale,\n    meta,\n    onChange,\n    options,\n    optionValue,\n    optionText,\n    perPage,\n    record,\n    reference,\n    resource,\n    setFilter,\n    setPagination,\n    setSort,\n    sort,\n    source,\n    textAlign,\n    translate,\n    translateChoice,\n    validation,\n    ...rest\n}: any) => rest;\n\nconst PREFIX = 'RaSelectArrayInput';\n\nexport const SelectArrayInputClasses = {\n    chips: `${PREFIX}-chips`,\n    chip: `${PREFIX}-chip`,\n};\n\nconst StyledFormControl = styled(FormControl, {\n    name: PREFIX,\n    overridesResolver: (props, styles) => styles.root,\n})(({ theme }) => ({\n    minWidth: theme.spacing(20),\n    [`& .${SelectArrayInputClasses.chips}`]: {\n        display: 'flex',\n        flexWrap: 'wrap',\n    },\n\n    [`& .${SelectArrayInputClasses.chip}`]: {\n        marginTop: theme.spacing(0.5),\n        marginRight: theme.spacing(0.5),\n    },\n}));\n"]},"metadata":{},"sourceType":"module"}